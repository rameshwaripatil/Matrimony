etimes=window.etimes||{};etimes.googleOneTap={};var constants={clientId:"103703403489-b4t4lt8mr05brqpcdrmsu0di54cmjv4f.apps.googleusercontent.com",scriptURL:"https://accounts.google.com/gsi/client",jssoAPIru:"bchjqhklhblchbhjglh1wbfbv",jssoAPIGetURL:window.location.href.includes("spmdev")||window.location.href.includes("toidev")?"https://jssostg.indiatimes.com/sso/services/gponetaplogin/verify":"https://jsso.indiatimes.com/sso/services/gponetaplogin/verify",nextShowTimeInDays:15,nextShowCookieName:"oneTapNextShow",sessionDuration:100,doNotInitiateOneTapByDefault:typeof __initializeOneTapForTOI!=="undefined"&&__initializeOneTapForTOI===false,module_name:"onetapsignin",yoloTimeout:5000};
var moduleData={didPromiseReturn:false,didOneTapPopUpShow:false};etimes.googleOneTap.jssoCallback=function(a,c,b){console.log("OneTapSign result",a);window.location.reload()};etimes.googleOneTap.googleCallBack=function(c){console.log("OneTapSign googleCallBack",c);if(typeof c.credential!=="undefined"){const b=new Date();window.localStorage.setItem("onetap_session",b.getTime()+12*60*60*1000);const e=c.credential;const a=constants.jssoAPIGetURL+"?token="+e+"&channel=toi&ru="+constants.jssoAPIru;var d=$.ajax({url:a,method:"GET",data:{token:e,channel:"toi",ru:constants.jssoAPIru},dataType:"jsonp",success:etimes.googleOneTap.jssoCallback});
moduleData.didPromiseReturn=true;moduleData.didOneTapPopUpShow=true}};etimes.googleOneTap.initiateAPI=function(a){console.log("OneTapSign initiate API called",google.accounts);google.accounts.id.initialize({client_id:constants.clientId,callback:etimes.googleOneTap.googleCallBack,cancel_on_tap_outside:false,auto_select:true});console.log("OneTapSign google.accounts",google.accounts.id);google.accounts.id.prompt(etimes.googleOneTap.handleGoogleNotificationResponses)};etimes.googleOneTap.handleGoogleNotificationResponses=function(c){var b=c.getNotDisplayedReason();
var a=c.getSkippedReason();var d=c.getDismissedReason();if(b||a||(d!="credential_returned"||typeof d!="undefined")){console.log("OneTapSign notification",c);if(c&&c.g==="display"&&c.h){setTimeout(etimes.googleOneTap.setTimerToClosePopup,90000);window.addEventListener("click",etimes.googleOneTap.closeOneTap)}}};etimes.googleOneTap.closeOneTap=function(b){const a=b.target&&typeof b.target.closest==="function"&&b.target.closest("#credential_picker_iframe");if(!a){etimes.googleOneTap.setTimerToClosePopup()
}};etimes.googleOneTap.setTimerToClosePopup=function(){if(window.google&&window.google.accounts&&window.google.accounts.id&&typeof window.google.accounts.id.cancel==="function"){window.google.accounts.id.cancel();window.removeEventListener("click",etimes.googleOneTap.closeOneTap,true)}};etimes.googleOneTap.checkIfOneTapPromiseReceived=function(){console.log("OneTapSign checkIfOneTapPromiseReceived called");var a=moduleData[constants.module_name];a&&a.onShowCallback&&a.onShowCallback(true)};etimes.googleOneTap.attachPostLoginHTML=function(b){var c='<div class="ontap-background id_postLogin hide"><div class="tap-message"><span class="success"></span><span class="text">Successfully signed in as '+b.getEmail()+'</span><span class="close id_onetapclose"></span></div></div>';
var a=$(".header_top .fix_wrapper");if(a.length===1){a.append(c)}else{$("body").append(c)}$(".id_postLogin").slideToggle();$(".id_onetapclose").on("click",function(){$(".id_postLogin").slideToggle()});setTimeout(function(){var d=$(".id_postLogin");if(d.is(":visible")){d.slideToggle()}},30000)};etimes.googleOneTap.bindFunction=function(){console.log("OneTapSign bind fn called",window.onGoogleLibraryLoad)};etimes.googleOneTap.loadjs=function(){console.log("OneTapSign loadjs called");try{(function(f,b,g){var e,c=f.getElementsByTagName(b)[0];
if(f.getElementById(g)){return}e=f.createElement(b);e.id=g;e.src="https://accounts.google.com/gsi/client";e.onload=etimes.googleOneTap.initiateAPI;c.parentNode.insertBefore(e,c)})(document,"script","onetap-jssdk")}catch(a){console.log("*** error loading onetap.js")}console.log("etimes.googleOneTap.checkIfOneTapPromiseReceived",etimes.googleOneTap);etimes.googleOneTap.checkIfOneTapPromiseReceived()};etimes.googleOneTap.loadAssets=function(){setTimeout(etimes.googleOneTap.loadjs,constants.sessionDuration)
};etimes.googleOneTap.registerWithPopupManager=function(){moduleData[constants.module_name]=TimesApps.PopUpManager.registerPopup(constants.module_name,etimes.googleOneTap.loadAssets)};etimes.googleOneTap.bindEvents=function(b){console.log("virendra",b);etimes.googleOneTap.loadAssets()};etimes.googleOneTap.init=function(){var a=function(){var f=toiprops.cookie.get(constants.nextShowCookieName);var d=false;var e=toiprops.cookie.get("ssoid")||toiprops.cookie.get("ssoId");var b=new Date();var c;if(!e){etimes.googleOneTap.bindEvents(2)
}};if(TimesApps.checkGdprAndCall){TimesApps.checkGdprAndCall(a)}else{if(TimesGDPR&&TimesGDPR.common&&TimesGDPR.common.consentModule&&TimesGDPR.common.consentModule.gdprCallback){TimesGDPR.common.consentModule.gdprCallback(a)}else{return}}};